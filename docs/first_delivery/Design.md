# Design

## High level architecture

![High Level Srchitecture](/docs/src/images/schemas/high_level_architecture.JPG)  
As shown in the picture, a set of sensors and actuators, grouped together in small clusters, are connected with an ESP32 controller.  
Based on the data received from the sensors, the controller manages the actuators by managing the speed/intensity and the switch-on state.  
The collected data will then be sent via the LoRa network to a remote AWS web server, where it will be stored for future analysis.

## Components

### Sensors

- Light sensor  
   ![Photoresistor](/docs/src/images/sensors_and_actuators/photoresistor.jpg)  
   The light sensor is used to detect the level of light inside the gallery.  
   This sensor will be disposed in variuous strategic locations inside the gallery, in order to evaluate in which areas the lights have to be activeted.

- Air quality sensor  
   ![Air quality sensor](/docs/src/images/sensors_and_actuators/air_quality_sensor.jpg)  
   The air quality sensor is used to detect the gas products generated by the combustion process combustion in vehicle engines.  
   Also this sensor will be disposed in variuous strategic locations inside the gallery, in order to evaluate in which areas the fan system have to be activeted.

### Actuators

- Fan system  
  A tunnel ventilation system is designed to perform the following functions:

  - Under normal operating conditions, dilute the gaseous products generated by the combustion process in vehicle engines and reduce the concentration of particulate matter;
  - In the event of an accident, extract and move, in a controlled manner, the smoke generated by fire events and clouds generated by gaseous phase releases of toxic and harmful substances and from liquid-phase spills of flammable substances.

  The ventilation consists in a set of electric motor actuators managed by the ESP32 controller connected to a fan to generate airflow.

- Lighting system  
  A lighting system is designed to perform the following functions:

  - Under normal operating conditions, lighten the tunnel to allow the normal movement of cars and pedestrians in safety;
  - In the event of an accident, activate the emergency lights to warn users and help them follow safety guidelines to stay safe inside the facility.

  The lightening consists in a set of actuator switches used to activate or deactivate the gallery lightening system and the traffic lights.

## Network

As mentioned at the beginning of this file, the data received by the sensors needs to be sent to a remote AWS web server.  
The connection between the ESP32 board and the IoT network works via the LoRa network to transmit the collected data, ensuring low power consumption.  
The ESP board will be placed in a position within the tunnel with LoRa network coverage..

## Web server

The web server is responsible of storing and managing the gathered information.  
It will be hosted on AWS and will provide a GUI to visualize and use the collected data.
