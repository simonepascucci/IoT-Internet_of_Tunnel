# Design

The proper functioning of the system depends on several complex technical aspects to be taken into account. In this section, we would like to address these issues in a real case scenario, describing the solutions and adaptations made to create the prototype.

## Technical aspects

The first step to do to before starting the developement and deployment of the system is a deep analysis of the specific characteristic of the tunnel and the regulations to be complied with.  
Taking into account that our project aims to automatically monitor and maintain the air quality and lighting conditions prioritizing energy efficiency, the main factors to be taken into account are:

1. It is essential to have a regulamentation that defines the rules to be respected, to properly design the system for the specific needings. The air quality sistem must be based on a list of air pollutants to be monitored and their respective treshold values. Also the minimum level of light to be guaranteed inside the tunnel must be clearly defined.  
    To make consistent assumptions for the development of this project we referred to the current Ambient Air Quality and Clean Air for Europe Standards of 2008.  
    It exposes a list of a set of air elements harmful to humans, accompanied by their respective threshold levels and permissible maximum exposure durations.  
    The following list illustrates the components on the list generated by motor vehicles:
   | Pollutant | Formula | Maximum concentration | Maximum exposition time |
   | :----------------- | :-----: | --------------------: | ----------------------- |
   | carbon dioxide | CO2 | 1800 mg/m3 | 8 hour |
   | carbon monoxide | CO | 10 mg/m3 | 8 hour |
   | Nitrogen dioxide | NO2 | 200 mg/m3 | 1 hour |
   | Sulphur dioxide | SO2 | 350 mg/m3 | 1 hour |
   | Particulate matter | PM10 | 50 mg/m3 | 24 hour |

2. Once the regulamentation is clarified, it is necessary to understand the characteristics of the specific tunnel in terms of dimensions, expected traffic, type of users, normal light conditions etc.
   This characteristic facilitates the comprehension of actuator specifications, determining the required quantity and strategic placements for optimal positioning.  
   Considering the environmental conditions is also crucial to enable connectivity of the monitoring system to the internet.

## Adapting the Prototype

We tried to design a prototype that reflects in a reasonable way a real case scenario, by making feasible estimations and assumptions in relation to the equipment at our disposal.
The dimensions of the cardboard used to simulate the tunnel are 50cm x 40cm x 80cm, resulting in a total air volume of 0.18m³.

### Sensors

**Air quality**  
**Light**

### Actuators

**Fan**  
![](/docs/src/images/sensors_and_actuators/fan.JPG)  
We employed a simplistic method to estimate the fan airflow, considering that in the simulation scenario, this calculation serves as a rough approximation for guidance purposes, without requiring excessive complexity.  
The fan speed is controlled through PWM modulation, using three different speed settings.  
The formula results in:

**Airflow = fan · area · fan_speed · efficiency_factor**
| Data | value | units of measure |
| :----------------- | :-----: | ----------------------- |
| fan_max_speed | 44 | m/s |
| fan_mid_speed | 30 | m/s |
| fan_low_speed | 15 | m/s |
| effinciency_factor | 0.3|

| Airflow max speed | Airflow mid speed | Airflow low speed |
| :---------------- | :---------------: | ----------------- |
| 0.033 m³/s        |    0.023 m³/s     | 0.011 m³/s        |

With an energy consumprion of
| Airflow max speed | Airflow mid speed | Airflow low speed |
| :---------------- | :---------------: | ----------------- |
| 100 mA | 90mA | 80mA |

Based on this estimation, we can determine the time it takes for a fan to circulate an air volume equivalent to that of the cardboard:

| Fan max speed | Fan mid speed | Fan low speed |
| :------------ | :-----------: | ------------- |
| 6s            |      8s       | 17s           |

**Light**  
![](/docs/src/images/sensors_and_actuators/light.jpg)  
By positioning the light source on top of the cardboard, it generates a cone of light on the bottom with a radius of 15cm. Consequently, we opted to utilize six light bulbs to adequately illuminate the entire length of the cardboard. During measurements taken at the center of the cone, the recorded light intensity reached approximately 1600 units.

## Managing the components

The light sensors will be activated every 15 minutes.
The air quality sensor will be activated every 5 minutes in normal conditions

## Network architecture

![](/docs/src/images/schemas/network_architecture.jpg)
